<br />
<div align="center">
  <img src="https://static.sismo.io/readme/top-secondary.png" alt="Logo" width="150" height="150" style="borderRadius: 20px">

  <h3 align="center">
    Prove with Sismo (PwS) Verifier
  </h3>

  <p align="center">
    Made by <a href="https://docs.sismo.io/" target="_blank">Sismo</a>
  </p>
  
  <p align="center">
    <a href="https://discord.gg/sismo" target="_blank">
        <img src="https://img.shields.io/badge/Discord-7289DA?style=for-the-badge&logo=discord&logoColor=white"/>
    </a>
    <a href="https://twitter.com/sismo_eth" target="_blank">
        <img src="https://img.shields.io/badge/Twitter-1DA1F2?style=for-the-badge&logo=twitter&logoColor=white"/>
    </a>
  </p>
</div>

[Prove with Sismo presentation]

We advise you to use directly [@sismo-core/pws](../pws) rather than this package.

## Installation

```
$ yarn add @sismo-core/pws-verifier
$ npm i @sismo-core/pws-verifier
```

## Usage

```javascript
import { PwSVerifier } from "@sismo-core/pws-verifier";
import { isInDatabase, storeInDatabase } from "..";

const isVerified = (proof) => {
  const pws = new PwSVerifier({ appId: "[Your app id]" });
  const verifiedClaim = await pws.verify({ proof: proof });

  if (verifiedClaim.groupId !== "[Group id]") return false;
  if (verifiedClaim.value < 3) return false;
  if (isInDatabase(verifiedClaim.nullifier)) return false;

  storeInDatabase(verifiedClaim.nullifier);

  return true;
}
```

## Documentation

You can find [here](https://www.notion.so/sismo/PwS-docs-819e88670d1c4d4e830d391d946a7858) the full documentation of the Prove with Sismo from how to get your appId to how to manage and verify your nullifiers.

### PwSVerifier

**Initialization** 
```javascript
const pws = new PwSVerifier({ appId: "[Your app id]" });
```

| Params | Type | Description |
|---|---|---|
| appId | String | Identifier of your app ([learn more](https://www.notion.so/sismo/PwS-docs-819e88670d1c4d4e830d391d946a7858)) |

**verify** 
```javascript
const verifiedClaim = await pws.verify({ proof: proof });
```

| Params | Type | Description |
|---|---|---|
| proof | Proof | Proof generated by the user |

If the proof is valid the function return a VerifiedClaim if not return an error

```javascript
type Proof = {
  request: Request;
  content: string;
}

type Request = {
  appId: string;
  serviceName: string;
  groupId: string;
  timestamp: "latest" | number;
  acceptHigherValues: boolean;
  value: "MAX" | number;
}

type VerifiedClaim = { 
  isValid: true;
  nullifier: string;
  value: number;
  groupName: string;
  timestamp: number;
  isStrict: boolean;
}

type Error = { 
  isValid: false;
  message: string;
}
```

**verify optional params** 

```javascript
const verifiedClaim = await pws.verify({ proof: proof, serviceId: "[Your service name]" });
```

| Params | Type | Description |
|---|---|---|
| serviceId | String | Service id of the proof, define the scope of the user nullifier. This serviceId must match with the serviceId used during the proof generation|

## License

Distributed under the MIT License.

## Contribute

Please, feel free to open issues, PRs or simply provide feedback!

## Contact

Prefer [Discord](https://discord.gg/sismo) or [Twitter](https://twitter.com/sismo_eth)

<br/>
<img src="https://static.sismo.io/readme/bottom-secondary.png" alt="bottom" width="100%" >
