<br />
<div align="center">
  <img src="https://static.sismo.io/readme/top-main.png" alt="Logo" width="150" height="150" style="borderRadius: 20px">

  <h3 align="center">
    ZK Connect Client
  </h3>

  <p align="center">
    Made by <a href="https://docs.sismo.io/" target="_blank">Sismo</a>
  </p>
  
  <p align="center">
    <a href="https://discord.gg/sismo" target="_blank">
        <img src="https://img.shields.io/badge/Discord-7289DA?style=for-the-badge&logo=discord&logoColor=white"/>
    </a>
    <a href="https://twitter.com/sismo_eth" target="_blank">
        <img src="https://img.shields.io/badge/Twitter-1DA1F2?style=for-the-badge&logo=twitter&logoColor=white"/>
    </a>
  </p>
</div>

ZK Connect is a privacy-preserving single sign-on method for applications. Once integrated, applications can request private, granular data from users, while users can authenticate and selectively reveal their data thanks to zero-knowledge proofs (ZKPs). 

The ZK Connect Client is a frontend package to easily request ZKPs from users of Sismo in a privacy-preserving manner.

You can see the GitHub repository [here](https://github.com/sismo-core/zk-connect-packages) and the backend package [here](https://github.com/sismo-core/zk-connect-packages/tree/main/packages/zk-connect-server).

In order to use ZK Connect, you will need to have an `appId` registered in the Sismo Factory. You can register your appId [here](https://factory.sismo.io/apps-explorer).

You can see this guide for a full example of how to integrate ZK Connect in your application: [ZK Connect Guide](https://docs.sismo.io/docs/zk-connect-guide).


## Installation

Install ZK Connect client package with npm:
```
# with npm
npm install @sismo-core/zk-connect-client
# with yarn
yarn add @sismo-core/zk-connect-client
```

## Usage

```javascript
import { ZkConnect, DataRequest } from '@sismo-core/zk-connect-client';

const zkConnect = new ZkConnect({ 
  appId: "your-app-id" 
});

// The `request` function sends your user to the Sismo vault app to generate the proof.
// After his proof is generated, he is redirect with it to your app 
zkConnect.request({  
    dataRequest: new DataRequest({ groupId: "your-group-id" }), 
});

// The `getResponse` function returns the proof generated by your user after coming back from Sismo Vault app.
const zkConnectResponse = zkConnect.getResponse();
```

## Documentation

### `request()`

```javascript
function request({ dataRequest, serviceName, callbackPath }: RequestParams): void
```

The `request` function sends your user to the Sismo Vault App to generate the proof.

| Params | Type | Required | Default | Description |
|---|---|---|---|---|
| dataRequest | DataRequest | false | undefined | Contains the statements from which proofs are created |
| namespace | string | false | "main" | service from which the proof is ask |
| callbackPath | string | false | the url from where you user was redirected to the Sismo Vault app | path to redirect users when the proof is generated |

The DataRequest object holds all the information needed to generate the proofs. When creating a dataRequest, you build statementRequests from which verifiableStatements will be created when calling `request` function. The proofs are located in those verifiableStatements. 

If no `dataRequest` is provided, the user will be redirected to the Sismo Vault app to generate a proof that he owns a vault. The proof will be located in the `proof` field of an `authProof` instead of a `verifiableStatement`.

### `DataRequest`

```typescript
class DataRequest {
  constructor(args: {
    // The statementRequests from which proofs are created
    // for now only one statementRequest is supported
    // you can input it directly or use the optional fields below to build it
    statementRequests?: StatementRequest[];

    operator?: LogicalOperator;
    // The groupId from which the proofs are generated
    groupId?: string;
    // The timestamp of the group from which the proofs are generated
    groupTimestamp?: number | "latest";
    // The value used in the statement request
    requestedValue?: number | "USER_SELECTED_VALUE";
    // the comparator used for the requestedValue
    // can be "GTE" or "EQ"
    comparator?: StatementComparator;
    // The proving scheme used to generate the proof
    provingScheme?: ProvingScheme;
    // Some extraData in the statements
    extraData?: StatementRequestExtraData;
  })
}

export type StatementRequest = {
  groupId: string;
  groupTimestamp?: number | "latest"; // default to "latest"
  requestedValue?: number | "USER_SELECTED_VALUE";
  comparator?: StatementComparator; // default to "GTE". , "EQ" If requestedValue="USER_SELECTED_VALUE"
  provingScheme?: any;
  extraData?: StatementRequestExtraData;
};
```

### `getResponse()`

```javascript
function getResponse(): ZkConnectResponse | null
```

The `getResponse` function returns the proof generated by your user after coming back from Sismo Vault app.
This proof must be sends to your backend and verify thanks to the `@sismo-core/zk-connect-server` package.


## License

Distributed under the MIT License.

## Contribute

Please, feel free to open issues, PRs or simply provide feedback!

## Contact

Prefer [Discord](https://discord.gg/sismo) or [Twitter](https://twitter.com/sismo_eth)

<br/>
<img src="https://static.sismo.io/readme/bottom-main.png" alt="bottom" width="100%" >
